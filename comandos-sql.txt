create table Aluno (
	id uuid not null primary key,
	email varchar(255) not null unique,
	nome varchar(255),
	matricula int unique,
	senha varchar(255) not null,
	constraint chk_email check (email like '%@%')
);

create table Coordenador (
	id uuid not null primary key,
	email varchar(255) not null unique,
	senha varchar(255) not null,
	constraint chk_email check (email like '%@%')
);

insert into aluno (id, email, nome, matricula, senha) values ('7b9d4686-180a-4aa7-9524-0ad2f835d8f5', 'luizmiguelgb@gmail.com', 'Luiz', '2818973', 'lm130707');


create table edital (
	id UUID not null primary key,
	data_inicio date not null,
	data_final date not null,
	maximo_inscricoes_aluno int not null,
	peso_cre float not null,
	peso_media float not null
);

create table disciplina (
	id UUID not null primary key,
	nome_disciplina varchar(100) not null,
	vagas_remuneradas int not null,
	vagas_voluntarias int not null,
	id_edital UUID not null references edital(id)
);

create table inscricao (
	id uuid not null primary key,
	id_aluno uuid not null references aluno(id),
	id_disciplina uuid not null references disciplina(id),
	data_inscricao timestamp default now(),
	resultado_inscricao varchar(50) not null,
	constraint chk_resultado_aluno check (resultado_inscricao in ('APROVADO', 'REPROVADO', 'PENDENTE'))
);

alter table edital add column encerrado boolean default false;

alter table inscricao add column cre_aluno float not null default 0.0;
alter table inscricao add column media_aluno float not null default 0.0;

alter table inscricao
    drop constraint chk_resultado_aluno;

alter table inscricao
    add constraint chk_resultado_aluno
    check (resultado_inscricao in ('APROVADO', 'REPROVADO', 'PENDENTE', 'DESISTENTE'));


alter table edital drop column if exists encerrado;

alter table edital add column status varchar(30) not null default 'ABERTO';
alter table edital add constraint chk_status check (status in ('ABERTO', 'ENCERRADO', 'RESULTADO_PRELIMINAR', 'RESULTADO_FINAL'))

alter table inscricao drop constraint chk_resultado_aluno;

alter table inscricao add constraint chk_resultado_aluno check (resultado_inscricao in ('APROVADO_BOLSA', 'APROVADO_VOLUNTARIO', 'PENDENTE', 'REPROVADO', 'DESISTENTE'))